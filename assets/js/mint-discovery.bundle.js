/*! For license information please see mint-discovery.bundle.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.MintDiscovery=e():t.MintDiscovery=e()}(this,()=>{return t={29(t,e,n){"use strict";var r,o=Object.defineProperty,s=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,c={};((t,e)=>{for(var n in e)o(t,n,{get:e[n],enumerable:!0})})(c,{AbstractSimplePool:()=>I,SimplePool:()=>R,useWebSocketImplementation:()=>O}),t.exports=(r=c,((t,e,n,r)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let n of i(e))a.call(t,n)||void 0===n||o(t,n,{get:()=>e[n],enumerable:!(r=s(e,n))||r.enumerable});return t})(o({},"__esModule",{value:!0}),r));var u=n(510),f=n(175),l=Symbol("verified");var h=n(623),d=(n(175),new TextDecoder("utf-8"),new TextEncoder);function p(t){try{-1===t.indexOf("://")&&(t="wss://"+t);let e=new URL(t);return"http:"===e.protocol?e.protocol="ws:":"https:"===e.protocol&&(e.protocol="wss:"),e.pathname=e.pathname.replace(/\/+/g,"/"),e.pathname.endsWith("/")&&(e.pathname=e.pathname.slice(0,-1)),("80"===e.port&&"ws:"===e.protocol||"443"===e.port&&"wss:"===e.protocol)&&(e.port=""),e.searchParams.sort(),e.hash="",e.toString()}catch(e){throw new Error(`Invalid URL: ${t}`)}}var y=class{value;next=null;prev=null;constructor(t){this.value=t}},g=class{first;last;constructor(){this.first=null,this.last=null}enqueue(t){const e=new y(t);return this.last?this.last===this.first?(this.last=e,this.last.prev=this.first,this.first.next=e):(e.prev=this.last,this.last.next=e,this.last=e):(this.first=e,this.last=e),!0}dequeue(){if(!this.first)return null;if(this.first===this.last){const t=this.first;return this.first=null,this.last=null,t.value}const t=this.first;return this.first=t.next,this.first&&(this.first.prev=null),t.value}};function w(t){let e=(0,h.sha256)(d.encode(function(t){if(!function(t){if(!(t instanceof Object))return!1;if("number"!=typeof t.kind)return!1;if("string"!=typeof t.content)return!1;if("number"!=typeof t.created_at)return!1;if("string"!=typeof t.pubkey)return!1;if(!t.pubkey.match(/^[a-f0-9]{64}$/))return!1;if(!Array.isArray(t.tags))return!1;for(let e=0;e<t.tags.length;e++){let n=t.tags[e];if(!Array.isArray(n))return!1;for(let t=0;t<n.length;t++)if("string"!=typeof n[t])return!1}return!0}(t))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content])}(t)));return(0,f.bytesToHex)(e)}var m=new class{generateSecretKey(){return u.schnorr.utils.randomPrivateKey()}getPublicKey(t){return(0,f.bytesToHex)(u.schnorr.getPublicKey(t))}finalizeEvent(t,e){const n=t;return n.pubkey=(0,f.bytesToHex)(u.schnorr.getPublicKey(e)),n.id=w(n),n.sig=(0,f.bytesToHex)(u.schnorr.sign(w(n),e)),n[l]=!0,n}verifyEvent(t){if("boolean"==typeof t[l])return t[l];const e=w(t);if(e!==t.id)return t[l]=!1,!1;try{const n=u.schnorr.verify(t.sig,e,t.pubkey);return t[l]=n,n}catch(e){return t[l]=!1,!1}}},b=(m.generateSecretKey,m.getPublicKey,m.finalizeEvent,m.verifyEvent);function v(t,e){if(t.ids&&-1===t.ids.indexOf(e.id))return!1;if(t.kinds&&-1===t.kinds.indexOf(e.kind))return!1;if(t.authors&&-1===t.authors.indexOf(e.pubkey))return!1;for(let n in t)if("#"===n[0]){let r=t[`#${n.slice(1)}`];if(r&&!e.tags.find(([t,e])=>t===n.slice(1)&&-1!==r.indexOf(e)))return!1}return!(t.since&&e.created_at<t.since||t.until&&e.created_at>t.until)}async function E(){return new Promise((t,e)=>{try{if("undefined"!=typeof MessageChannel){const e=new MessageChannel,n=()=>{e.port1.removeEventListener("message",n),t()};e.port1.addEventListener("message",n),e.port2.postMessage(0),e.port1.start()}else"undefined"!=typeof setImmediate?setImmediate(t):"undefined"!=typeof setTimeout?setTimeout(t,0):t()}catch(t){console.error("during yield: ",t),e(t)}})}var B,x=t=>(t[l]=!0,!0),A=class extends Error{constructor(t,e){super(`Tried to send message '${t} on a closed connection to ${e}.`),this.name="SendingOnClosedConnection"}},S=class{url;_connected=!1;onclose=null;onnotice=t=>console.debug(`NOTICE from ${this.url}: ${t}`);onauth;baseEoseTimeout=4400;connectionTimeout=4400;publishTimeout=4400;pingFrequency=29e3;pingTimeout=2e4;resubscribeBackoff=[1e4,1e4,1e4,2e4,2e4,3e4,6e4];openSubs=new Map;enablePing;enableReconnect;connectionTimeoutHandle;reconnectTimeoutHandle;pingIntervalHandle;reconnectAttempts=0;closedIntentionally=!1;connectionPromise;openCountRequests=new Map;openEventPublishes=new Map;ws;incomingMessageQueue=new g;queueRunning=!1;challenge;authPromise;serial=0;verifyEvent;_WebSocket;constructor(t,e){this.url=p(t),this.verifyEvent=e.verifyEvent,this._WebSocket=e.websocketImplementation||WebSocket,this.enablePing=e.enablePing,this.enableReconnect=e.enableReconnect||!1}static async connect(t,e){const n=new S(t,e);return await n.connect(),n}closeAllSubscriptions(t){for(let[e,n]of this.openSubs)n.close(t);this.openSubs.clear();for(let[e,n]of this.openEventPublishes)n.reject(new Error(t));this.openEventPublishes.clear();for(let[e,n]of this.openCountRequests)n.reject(new Error(t));this.openCountRequests.clear()}get connected(){return this._connected}async reconnect(){const t=this.resubscribeBackoff[Math.min(this.reconnectAttempts,this.resubscribeBackoff.length-1)];this.reconnectAttempts++,this.reconnectTimeoutHandle=setTimeout(async()=>{try{await this.connect()}catch(t){}},t)}handleHardClose(t){this.pingIntervalHandle&&(clearInterval(this.pingIntervalHandle),this.pingIntervalHandle=void 0),this._connected=!1,this.connectionPromise=void 0;const e=this.closedIntentionally;this.closedIntentionally=!1,this.onclose?.(),this.enableReconnect&&!e?this.reconnect():this.closeAllSubscriptions(t)}async connect(){return this.connectionPromise||(this.challenge=void 0,this.authPromise=void 0,this.connectionPromise=new Promise((t,e)=>{this.connectionTimeoutHandle=setTimeout(()=>{e("connection timed out"),this.connectionPromise=void 0,this.onclose?.(),this.closeAllSubscriptions("relay connection timed out")},this.connectionTimeout);try{this.ws=new this._WebSocket(this.url)}catch(t){return clearTimeout(this.connectionTimeoutHandle),void e(t)}this.ws.onopen=()=>{this.reconnectTimeoutHandle&&(clearTimeout(this.reconnectTimeoutHandle),this.reconnectTimeoutHandle=void 0),clearTimeout(this.connectionTimeoutHandle),this._connected=!0;const e=this.reconnectAttempts>0;this.reconnectAttempts=0;for(const t of this.openSubs.values()){if(t.eosed=!1,e)for(let e=0;e<t.filters.length;e++)t.lastEmitted&&(t.filters[e].since=t.lastEmitted+1);t.fire()}this.enablePing&&(this.pingIntervalHandle=setInterval(()=>this.pingpong(),this.pingFrequency)),t()},this.ws.onerror=t=>{clearTimeout(this.connectionTimeoutHandle),e(t.message||"websocket error"),this.handleHardClose("relay connection errored")},this.ws.onclose=t=>{clearTimeout(this.connectionTimeoutHandle),e(t.message||"websocket closed"),this.handleHardClose("relay connection closed")},this.ws.onmessage=this._onmessage.bind(this)})),this.connectionPromise}waitForPingPong(){return new Promise(t=>{this.ws.once("pong",()=>t(!0)),this.ws.ping()})}waitForDummyReq(){return new Promise((t,e)=>{if(!this.connectionPromise)return e(new Error(`no connection to ${this.url}, can't ping`));try{const e=this.subscribe([{ids:["aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"],limit:0}],{label:"forced-ping",oneose:()=>{t(!0),e.close()},onclose(){t(!0)},eoseTimeout:this.pingTimeout+1e3})}catch(t){e(t)}})}async pingpong(){1===this.ws?.readyState&&(await Promise.any([this.ws&&this.ws.ping&&this.ws.once?this.waitForPingPong():this.waitForDummyReq(),new Promise(t=>setTimeout(()=>t(!1),this.pingTimeout))])||this.ws?.readyState===this._WebSocket.OPEN&&this.ws?.close())}async runQueue(){for(this.queueRunning=!0;!1!==this.handleNext();)await E();this.queueRunning=!1}handleNext(){const t=this.incomingMessageQueue.dequeue();if(!t)return!1;const e=function(t){let e=t.slice(0,22).indexOf('"EVENT"');if(-1===e)return null;let n=t.slice(e+7+1).indexOf('"');if(-1===n)return null;let r=e+7+1+n,o=t.slice(r+1,80).indexOf('"');if(-1===o)return null;let s=r+1+o;return t.slice(r+1,s)}(t);if(e){const n=this.openSubs.get(e);if(!n)return;const r=function(t){let e=t.indexOf('"id":')+5,n=t.slice(e).indexOf('"')+e+1;return t.slice(n,n+64)}(t),o=n.alreadyHaveEvent?.(r);if(n.receivedEvent?.(this,r),o)return}try{let e=JSON.parse(t);switch(e[0]){case"EVENT":{const t=this.openSubs.get(e[1]),n=e[2];return this.verifyEvent(n)&&function(t,e){for(let n=0;n<t.length;n++)if(v(t[n],e))return!0;return!1}(t.filters,n)&&t.onevent(n),void((!t.lastEmitted||t.lastEmitted<n.created_at)&&(t.lastEmitted=n.created_at))}case"COUNT":{const t=e[1],n=e[2],r=this.openCountRequests.get(t);return void(r&&(r.resolve(n.count),this.openCountRequests.delete(t)))}case"EOSE":{const t=this.openSubs.get(e[1]);if(!t)return;return void t.receivedEose()}case"OK":{const t=e[1],n=e[2],r=e[3],o=this.openEventPublishes.get(t);return void(o&&(clearTimeout(o.timeout),n?o.resolve(r):o.reject(new Error(r)),this.openEventPublishes.delete(t)))}case"CLOSED":{const t=e[1],n=this.openSubs.get(t);if(!n)return;return n.closed=!0,void n.close(e[2])}case"NOTICE":return void this.onnotice(e[1]);case"AUTH":return this.challenge=e[1],void(this.onauth&&this.auth(this.onauth));default:{const t=this.openSubs.get(e[1]);return void t?.oncustom?.(e)}}}catch(t){return}}async send(t){if(!this.connectionPromise)throw new A(t,this.url);this.connectionPromise.then(()=>{this.ws?.send(t)})}async auth(t){const e=this.challenge;if(!e)throw new Error("can't perform auth, no challenge was received");return this.authPromise||(this.authPromise=new Promise(async(n,r)=>{try{let o=await t(function(t,e){return{kind:22242,created_at:Math.floor(Date.now()/1e3),tags:[["relay",t],["challenge",e]],content:""}}(this.url,e)),s=setTimeout(()=>{let t=this.openEventPublishes.get(o.id);t&&(t.reject(new Error("auth timed out")),this.openEventPublishes.delete(o.id))},this.publishTimeout);this.openEventPublishes.set(o.id,{resolve:n,reject:r,timeout:s}),this.send('["AUTH",'+JSON.stringify(o)+"]")}catch(t){console.warn("subscribe auth function failed:",t)}})),this.authPromise}async publish(t){const e=new Promise((e,n)=>{const r=setTimeout(()=>{const e=this.openEventPublishes.get(t.id);e&&(e.reject(new Error("publish timed out")),this.openEventPublishes.delete(t.id))},this.publishTimeout);this.openEventPublishes.set(t.id,{resolve:e,reject:n,timeout:r})});return this.send('["EVENT",'+JSON.stringify(t)+"]"),e}async count(t,e){this.serial++;const n=e?.id||"count:"+this.serial,r=new Promise((t,e)=>{this.openCountRequests.set(n,{resolve:t,reject:e})});return this.send('["COUNT","'+n+'",'+JSON.stringify(t).substring(1)),r}subscribe(t,e){const n=this.prepareSubscription(t,e);return n.fire(),n}prepareSubscription(t,e){this.serial++;const n=e.id||(e.label?e.label+":":"sub:")+this.serial,r=new T(this,n,t,e);return this.openSubs.set(n,r),r}close(){this.closedIntentionally=!0,this.reconnectTimeoutHandle&&(clearTimeout(this.reconnectTimeoutHandle),this.reconnectTimeoutHandle=void 0),this.pingIntervalHandle&&(clearInterval(this.pingIntervalHandle),this.pingIntervalHandle=void 0),this.closeAllSubscriptions("relay connection closed by us"),this._connected=!1,this.onclose?.(),this.ws?.readyState===this._WebSocket.OPEN&&this.ws?.close()}_onmessage(t){this.incomingMessageQueue.enqueue(t.data),this.queueRunning||this.runQueue()}},T=class{relay;id;lastEmitted;closed=!1;eosed=!1;filters;alreadyHaveEvent;receivedEvent;onevent;oneose;onclose;oncustom;eoseTimeout;eoseTimeoutHandle;constructor(t,e,n,r){if(0===n.length)throw new Error("subscription can't be created with zero filters");this.relay=t,this.filters=n,this.id=e,this.alreadyHaveEvent=r.alreadyHaveEvent,this.receivedEvent=r.receivedEvent,this.eoseTimeout=r.eoseTimeout||t.baseEoseTimeout,this.oneose=r.oneose,this.onclose=r.onclose,this.onevent=r.onevent||(t=>{console.warn(`onevent() callback not defined for subscription '${this.id}' in relay ${this.relay.url}. event received:`,t)})}fire(){this.relay.send('["REQ","'+this.id+'",'+JSON.stringify(this.filters).substring(1)),this.eoseTimeoutHandle=setTimeout(this.receivedEose.bind(this),this.eoseTimeout)}receivedEose(){this.eosed||(clearTimeout(this.eoseTimeoutHandle),this.eosed=!0,this.oneose?.())}close(t="closed by caller"){if(!this.closed&&this.relay.connected){try{this.relay.send('["CLOSE",'+JSON.stringify(this.id)+"]")}catch(t){if(!(t instanceof A))throw t}this.closed=!0}this.relay.openSubs.delete(this.id),this.onclose?.(t)}},I=class{relays=new Map;seenOn=new Map;trackRelays=!1;verifyEvent;enablePing;enableReconnect;automaticallyAuth;trustedRelayURLs=new Set;_WebSocket;constructor(t){this.verifyEvent=t.verifyEvent,this._WebSocket=t.websocketImplementation,this.enablePing=t.enablePing,this.enableReconnect=t.enableReconnect||!1,this.automaticallyAuth=t.automaticallyAuth}async ensureRelay(t,e){t=p(t);let n=this.relays.get(t);if(n||(n=new S(t,{verifyEvent:this.trustedRelayURLs.has(t)?x:this.verifyEvent,websocketImplementation:this._WebSocket,enablePing:this.enablePing,enableReconnect:this.enableReconnect}),n.onclose=()=>{n&&!n.enableReconnect&&this.relays.delete(t)},e?.connectionTimeout&&(n.connectionTimeout=e.connectionTimeout),this.relays.set(t,n)),this.automaticallyAuth){const e=this.automaticallyAuth(t);e&&(n.onauth=e)}return await n.connect(),n}close(t){t.map(p).forEach(t=>{this.relays.get(t)?.close(),this.relays.delete(t)})}subscribe(t,e,n){const r=[];for(let n=0;n<t.length;n++){const o=p(t[n]);r.find(t=>t.url===o)||r.push({url:o,filter:e})}return this.subscribeMap(r,n)}subscribeMany(t,e,n){const r=[],o=[];for(let n=0;n<t.length;n++){const s=p(t[n]);-1===o.indexOf(s)&&(o.push(s),r.push({url:s,filter:e}))}return this.subscribeMap(r,n)}subscribeMap(t,e){const n=new Map;for(const e of t){const{url:t,filter:r}=e;n.has(t)||n.set(t,[]),n.get(t).push(r)}const r=Array.from(n.entries()).map(([t,e])=>({url:t,filters:e}));this.trackRelays&&(e.receivedEvent=(t,e)=>{let n=this.seenOn.get(e);n||(n=new Set,this.seenOn.set(e,n)),n.add(t)});const o=new Set,s=[],i=[];let a=t=>{i[t]||(i[t]=!0,i.filter(t=>t).length===r.length&&(e.oneose?.(),a=()=>{}))};const c=[];let u=(t,n)=>{c[t]||(a(t),c[t]=n,c.filter(t=>t).length===r.length&&(e.onclose?.(c),u=()=>{}))};const f=t=>{if(e.alreadyHaveEvent?.(t))return!0;const n=o.has(t);return o.add(t),n},l=Promise.all(r.map(async({url:t,filters:n},r)=>{let o;try{o=await this.ensureRelay(t,{connectionTimeout:e.maxWait?Math.max(.8*e.maxWait,e.maxWait-1e3):void 0})}catch(t){return void u(r,t?.message||String(t))}let i=o.subscribe(n,{...e,oneose:()=>a(r),onclose:t=>{t.startsWith("auth-required: ")&&e.onauth?o.auth(e.onauth).then(()=>{o.subscribe(n,{...e,oneose:()=>a(r),onclose:t=>{u(r,t)},alreadyHaveEvent:f,eoseTimeout:e.maxWait})}).catch(t=>{u(r,`auth was required and attempted, but failed with: ${t}`)}):u(r,t)},alreadyHaveEvent:f,eoseTimeout:e.maxWait});s.push(i)}));return{async close(t){await l,s.forEach(e=>{e.close(t)})}}}subscribeEose(t,e,n){const r=this.subscribe(t,e,{...n,oneose(){r.close("closed automatically on eose")}});return r}subscribeManyEose(t,e,n){const r=this.subscribeMany(t,e,{...n,oneose(){r.close("closed automatically on eose")}});return r}async querySync(t,e,n){return new Promise(async r=>{const o=[];this.subscribeEose(t,e,{...n,onevent(t){o.push(t)},onclose(t){r(o)}})})}async get(t,e,n){e.limit=1;const r=await this.querySync(t,e,n);return r.sort((t,e)=>e.created_at-t.created_at),r[0]||null}publish(t,e,n){return t.map(p).map(async(t,r,o)=>{if(o.indexOf(t)!==r)return Promise.reject("duplicate url");let s=await this.ensureRelay(t);return s.publish(e).catch(async t=>{if(t instanceof Error&&t.message.startsWith("auth-required: ")&&n?.onauth)return await s.auth(n.onauth),s.publish(e);throw t}).then(t=>{if(this.trackRelays){let t=this.seenOn.get(e.id);t||(t=new Set,this.seenOn.set(e.id,t)),t.add(s)}return t})})}listConnectionStatus(){const t=new Map;return this.relays.forEach((e,n)=>t.set(n,e.connected)),t}destroy(){this.relays.forEach(t=>t.close()),this.relays=new Map}};try{B=WebSocket}catch{}function O(t){B=t}var R=class extends I{constructor(t){super({verifyEvent:b,websocketImplementation:B,...t})}}},129(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.crypto=void 0,e.crypto="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0},130(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.randomBytes=e.wrapXOFConstructorWithOpts=e.wrapConstructorWithOpts=e.wrapConstructor=e.checkOpts=e.Hash=e.concatBytes=e.toBytes=e.utf8ToBytes=e.asyncLoop=e.nextTick=e.hexToBytes=e.bytesToHex=e.isLE=e.rotr=e.createView=e.u32=e.u8=void 0;const r=n(129),o=t=>t instanceof Uint8Array;if(e.u8=t=>new Uint8Array(t.buffer,t.byteOffset,t.byteLength),e.u32=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),e.createView=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),e.rotr=(t,e)=>t<<32-e|t>>>e,e.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0],!e.isLE)throw new Error("Non little-endian hardware is not supported");const s=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function i(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}function a(t){if("string"==typeof t&&(t=i(t)),!o(t))throw new Error("expected Uint8Array, got "+typeof t);return t}e.bytesToHex=function(t){if(!o(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=s[t[n]];return e},e.hexToBytes=function(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let e=0;e<n.length;e++){const r=2*e,o=t.slice(r,r+2),s=Number.parseInt(o,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");n[e]=s}return n},e.nextTick=async()=>{},e.asyncLoop=async function(t,n,r){let o=Date.now();for(let s=0;s<t;s++){r(s);const t=Date.now()-o;t>=0&&t<n||(await(0,e.nextTick)(),o+=t)}},e.utf8ToBytes=i,e.toBytes=a,e.concatBytes=function(...t){const e=new Uint8Array(t.reduce((t,e)=>t+e.length,0));let n=0;return t.forEach(t=>{if(!o(t))throw new Error("Uint8Array expected");e.set(t,n),n+=t.length}),e},e.Hash=class{clone(){return this._cloneInto()}};const c={}.toString;e.checkOpts=function(t,e){if(void 0!==e&&"[object Object]"!==c.call(e))throw new Error("Options should be object or undefined");return Object.assign(t,e)},e.wrapConstructor=function(t){const e=e=>t().update(a(e)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e},e.wrapConstructorWithOpts=function(t){const e=(e,n)=>t(n).update(a(e)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=e=>t(e),e},e.wrapXOFConstructorWithOpts=function(t){const e=(e,n)=>t(n).update(a(e)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=e=>t(e),e},e.randomBytes=function(t=32){if(r.crypto&&"function"==typeof r.crypto.getRandomValues)return r.crypto.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}},145(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.crypto=void 0,e.crypto="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0},175(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.randomBytes=e.wrapXOFConstructorWithOpts=e.wrapConstructorWithOpts=e.wrapConstructor=e.checkOpts=e.Hash=e.concatBytes=e.toBytes=e.utf8ToBytes=e.asyncLoop=e.nextTick=e.hexToBytes=e.bytesToHex=e.isLE=e.rotr=e.createView=e.u32=e.u8=void 0;const r=n(145),o=t=>t instanceof Uint8Array;if(e.u8=t=>new Uint8Array(t.buffer,t.byteOffset,t.byteLength),e.u32=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),e.createView=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),e.rotr=(t,e)=>t<<32-e|t>>>e,e.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0],!e.isLE)throw new Error("Non little-endian hardware is not supported");const s=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function i(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}function a(t){if("string"==typeof t&&(t=i(t)),!o(t))throw new Error("expected Uint8Array, got "+typeof t);return t}e.bytesToHex=function(t){if(!o(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=s[t[n]];return e},e.hexToBytes=function(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let e=0;e<n.length;e++){const r=2*e,o=t.slice(r,r+2),s=Number.parseInt(o,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");n[e]=s}return n},e.nextTick=async()=>{},e.asyncLoop=async function(t,n,r){let o=Date.now();for(let s=0;s<t;s++){r(s);const t=Date.now()-o;t>=0&&t<n||(await(0,e.nextTick)(),o+=t)}},e.utf8ToBytes=i,e.toBytes=a,e.concatBytes=function(...t){const e=new Uint8Array(t.reduce((t,e)=>t+e.length,0));let n=0;return t.forEach(t=>{if(!o(t))throw new Error("Uint8Array expected");e.set(t,n),n+=t.length}),e},e.Hash=class{clone(){return this._cloneInto()}},e.checkOpts=function(t,e){if(void 0!==e&&("object"!=typeof e||(n=e,"[object Object]"!==Object.prototype.toString.call(n)||n.constructor!==Object)))throw new Error("Options should be object or undefined");var n;return Object.assign(t,e)},e.wrapConstructor=function(t){const e=e=>t().update(a(e)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e},e.wrapConstructorWithOpts=function(t){const e=(e,n)=>t(n).update(a(e)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=e=>t(e),e},e.wrapXOFConstructorWithOpts=function(t){const e=(e,n)=>t(n).update(a(e)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=e=>t(e),e},e.randomBytes=function(t=32){if(r.crypto&&"function"==typeof r.crypto.getRandomValues)return r.crypto.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}},237(t,e,n){const{createNostrClient:r,DEFAULT_RELAYS:o}=n(903),{fetchMintInfoBatch:s,isCacheFresh:i}=n(620),{createAggregator:a}=n(436),{createStorage:c}=n(976);function u(t={}){const e={relays:t.relays||o,nostrTimeout:t.nostrTimeout||1e4,httpTimeout:t.httpTimeout||1e4,httpConcurrency:t.httpConcurrency||20,httpDelayMs:t.httpDelayMs||100,cacheMaxAge:t.cacheMaxAge||3600,useStorage:!1!==t.useStorage},u=r({relays:e.relays,timeout:e.nostrTimeout}),f=a(),l=e.useStorage?c():null;let h=[],d=!1;async function p(){if(l)try{const[t,e]=await Promise.all([l.getAllReviews(),l.getAllHttpInfo()]);for(const e of t)f.addReview(e);for(const t of e)f.setHttpInfo(t.url,t)}catch(t){}}return{discover:async function(t={}){if(d)return f.getRecommendations();d=!0;try{await p(),t.onProgress&&t.onProgress({phase:"nostr",step:"mint-info"});const n=await u.fetchMintInfoEvents();f.addMintInfos(n),t.onProgress&&t.onProgress({phase:"nostr",step:"reviews"});const r=await u.fetchReviewEvents();if(f.addReviews(r),l&&r.length>0)try{await l.saveReviews(r)}catch{}if(!t.skipHttpFetch){t.onProgress&&t.onProgress({phase:"http",step:"fetching"});const n=f.getAllUrls(),r=[];for(const t of n){const n=f.getRecommendation(t);n&&i(n,e.cacheMaxAge)||r.push(t)}if(r.length>0){const n=await s(r,{concurrency:e.httpConcurrency,delayMs:e.httpDelayMs,timeout:e.httpTimeout,onResult:async e=>{if(f.setHttpInfo(e.url,e),l)try{await l.saveHttpInfo(e.url,e)}catch{}t.onProgress&&t.onProgress({phase:"http",step:"fetched",url:e.url,error:e.error})}});f.setHttpInfoBatch(n)}}return t.onProgress&&t.onProgress({phase:"done"}),f.getRecommendations()}finally{d=!1}},discoverStreaming:async function(t={}){if(d)return f.getRecommendations();d=!0;try{await p();let n=!1,r=!1,o=!1;const a=async()=>{if(n&&r&&!o){o=!0,t.onProgress&&t.onProgress({phase:"http",step:"fetching"});const n=f.getAllUrls(),r=[];for(const t of n){const n=f.getRecommendation(t);n&&i(n,e.cacheMaxAge)||r.push(t)}r.length>0&&await s(r,{concurrency:e.httpConcurrency,delayMs:e.httpDelayMs,timeout:e.httpTimeout,onResult:async e=>{if(f.setHttpInfo(e.url,e),l)try{await l.saveHttpInfo(e.url,e)}catch{}if(t.onMint){const n=f.getRecommendation(e.url);n&&t.onMint(n)}t.onProgress&&t.onProgress({phase:"http",step:"fetched",url:e.url,error:e.error})}}),c.close(),h.close(),t.onProgress&&t.onProgress({phase:"done"}),t.onComplete&&t.onComplete(f.getRecommendations()),d=!1}};t.onProgress&&t.onProgress({phase:"nostr",step:"subscribing"});const c=u.subscribeMintInfo({onEvent:e=>{if(f.addMintInfo(e),t.onMint){const n=f.getRecommendation(e.url);n&&t.onMint(n)}},onEose:()=>{n=!0,t.onProgress&&t.onProgress({phase:"nostr",step:"mint-info-complete"}),a()}}),h=u.subscribeReviews({onEvent:async e=>{if(f.addReview(e),l)try{await l.saveReview(e)}catch{}if(t.onMint){const n=f.getRecommendation(e.url);n&&t.onMint(n)}},onEose:()=>{r=!0,t.onProgress&&t.onProgress({phase:"nostr",step:"reviews-complete"}),a()}});return new Promise(e=>{const n=t.onComplete;t.onComplete=t=>{n&&n(t),e(t)}})}catch(t){throw d=!1,t}},subscribe:function(t={}){const r=u.subscribeMintInfo({onEvent:async(r,o)=>{if(f.addMintInfo(r),r.url){const t=f.getRecommendation(r.url);if(!t||!i(t,e.cacheMaxAge)){const{fetchMintInfo:t}=n(620),o=await t(r.url,e.httpTimeout);if(f.setHttpInfo(r.url,o),l)try{await l.saveHttpInfo(r.url,o)}catch{}}}t.onMintInfo&&t.onMintInfo(r,o),t.onUpdate&&t.onUpdate(f.getRecommendations())}}),o=u.subscribeReviews({onEvent:async(e,n)=>{if(f.addReview(e),l)try{await l.saveReview(e)}catch{}t.onReview&&t.onReview(e,n),t.onUpdate&&t.onUpdate(f.getRecommendations())}});return h.push(r,o),()=>{r.close(),o.close(),h=h.filter(t=>t!==r&&t!==o)}},getRecommendations:function(){return f.getRecommendations()},getReviewsForMint:function(t){return f.getReviewsForUrl(t)},fetchReviewsForMint:async function(t){const e=await u.fetchReviewsForUrl(t);if(f.addReviews(e),l&&e.length>0)try{await l.saveReviews(e)}catch{}return f.getReviewsForUrl(t)},clearCache:async function(){if(f.clear(),l)try{await l.clearAll()}catch{}},getStats:function(){return f.getStats()},exportData:function(){return f.exportData()},importData:function(t){f.importData(t)},configure:function(t){t.relays&&(e.relays=t.relays),t.nostrTimeout&&(e.nostrTimeout=t.nostrTimeout),t.httpTimeout&&(e.httpTimeout=t.httpTimeout),t.httpConcurrency&&(e.httpConcurrency=t.httpConcurrency),t.httpDelayMs&&(e.httpDelayMs=t.httpDelayMs),t.cacheMaxAge&&(e.cacheMaxAge=t.cacheMaxAge)},close:function(){for(const t of h)try{t.close()}catch{}h=[],u.close(),l&&l.close()},aggregator:f,nostrClient:u,storage:l,config:e}}const f={create:u,DEFAULT_RELAYS:o};t.exports={MintDiscovery:f,create:u,DEFAULT_RELAYS:o,createNostrClient:n(903).createNostrClient,createAggregator:n(436).createAggregator,createStorage:n(976).createStorage,parseRatingAndComment:n(513).parseRatingAndComment,fetchMintInfo:n(620).fetchMintInfo,fetchMintInfoBatch:n(620).fetchMintInfoBatch}},346(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SHA2=void 0;const r=n(764),o=n(130);class s extends o.Hash{constructor(t,e,n,r){super(),this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,o.createView)(this.buffer)}update(t){(0,r.exists)(this);const{view:e,buffer:n,blockLen:s}=this,i=(t=(0,o.toBytes)(t)).length;for(let r=0;r<i;){const a=Math.min(s-this.pos,i-r);if(a===s){const e=(0,o.createView)(t);for(;s<=i-r;r+=s)this.process(e,r);continue}n.set(t.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===s&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,r.exists)(this),(0,r.output)(t,this),this.finished=!0;const{buffer:e,view:n,blockLen:s,isLE:i}=this;let{pos:a}=this;e[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>s-a&&(this.process(n,0),a=0);for(let t=a;t<s;t++)e[t]=0;!function(t,e,n,r){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,n,r);const o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),a=Number(n&s),c=r?4:0,u=r?0:4;t.setUint32(e+c,i,r),t.setUint32(e+u,a,r)}(n,s-8,BigInt(8*this.length),i),this.process(n,0);const c=(0,o.createView)(t),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=u/4,l=this.get();if(f>l.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<f;t++)c.setUint32(4*t,l[t],i)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:n,length:r,finished:o,destroyed:s,pos:i}=this;return t.length=r,t.pos=i,t.finished=o,t.destroyed=s,r%e&&t.buffer.set(n),t}}e.SHA2=s},422(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.validateBasic=e.wNAF=void 0;const r=n(967),o=n(484),s=BigInt(0),i=BigInt(1);e.wNAF=function(t,e){const n=(t,e)=>{const n=e.negate();return t?n:e},r=t=>({windows:Math.ceil(e/t)+1,windowSize:2**(t-1)});return{constTimeNegate:n,unsafeLadder(e,n){let r=t.ZERO,o=e;for(;n>s;)n&i&&(r=r.add(o)),o=o.double(),n>>=i;return r},precomputeWindow(t,e){const{windows:n,windowSize:o}=r(e),s=[];let i=t,a=i;for(let t=0;t<n;t++){a=i,s.push(a);for(let t=1;t<o;t++)a=a.add(i),s.push(a);i=a.double()}return s},wNAF(e,o,s){const{windows:a,windowSize:c}=r(e);let u=t.ZERO,f=t.BASE;const l=BigInt(2**e-1),h=2**e,d=BigInt(e);for(let t=0;t<a;t++){const e=t*c;let r=Number(s&l);s>>=d,r>c&&(r-=h,s+=i);const a=e,p=e+Math.abs(r)-1,y=t%2!=0,g=r<0;0===r?f=f.add(n(y,o[a])):u=u.add(n(g,o[p]))}return{p:u,f}},wNAFCached(t,e,n,r){const o=t._WINDOW_SIZE||1;let s=e.get(t);return s||(s=this.precomputeWindow(t,o),1!==o&&e.set(t,r(s))),this.wNAF(o,s,n)}}},e.validateBasic=function(t){return(0,r.validateField)(t.Fp),(0,o.validateObject)(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,r.nLength)(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}},436(t){t.exports={createAggregator:function(){const t=new Map,e=new Map,n=new Map;function r(e){if(!e||!e.url||!e.eventId)return;const n=e.url;let r=t.get(n)||[];r.some(t=>t.eventId===e.eventId)||(r=r.filter(t=>t.pubkey!==e.pubkey),r.push(e),r.sort((t,e)=>(t.created_at||0)-(e.created_at||0)),t.set(n,r))}function o(t){if(!t||!t.url)return;const n=e.get(t.url);(!n||(t.created_at||0)>(n.created_at||0))&&e.set(t.url,t)}function s(t,e){t&&e&&n.set(t,e)}function i(){const r=new Set;for(const e of t.keys())r.add(e);for(const t of e.keys())r.add(t);for(const t of n.keys())r.add(t);return Array.from(r)}return{addReview:r,addReviews:function(t){if(Array.isArray(t))for(const e of t)r(e)},addMintInfo:o,addMintInfos:function(t){if(Array.isArray(t))for(const e of t)o(e)},setHttpInfo:s,setHttpInfoBatch:function(t){if(Array.isArray(t))for(const e of t)e&&e.url&&s(e.url,e)},getAllUrls:i,getReviewsForUrl:function(e){return t.get(e)||[]},getRecommendations:function(){const e=i(),r=[];for(const o of e){const e=t.get(o)||[],s=n.get(o),i=e.map(t=>t.rating).filter(t=>"number"==typeof t&&t>=1&&t<=5),a=i.length>0?i.reduce((t,e)=>t+e,0)/i.length:null;r.push({url:o,reviewsCount:e.length,averageRating:a,info:s?.info||void 0,error:s?.error||!1,lastHttpInfoFetchAt:s?.fetchedAt||void 0})}return r.sort((t,e)=>{const n=e.reviewsCount-t.reviewsCount;return 0!==n?n:(e.averageRating||0)-(t.averageRating||0)}),r},getRecommendation:function(r){const o=t.get(r)||[],s=n.get(r);if(0===o.length&&!e.has(r)&&!s)return null;const i=o.map(t=>t.rating).filter(t=>"number"==typeof t&&t>=1&&t<=5),a=i.length>0?i.reduce((t,e)=>t+e,0)/i.length:null;return{url:r,reviewsCount:o.length,averageRating:a,info:s?.info||void 0,error:s?.error||!1,lastHttpInfoFetchAt:s?.fetchedAt||void 0}},clear:function(){t.clear(),e.clear(),n.clear()},getStats:function(){let r=0;for(const e of t.values())r+=e.length;return{mintCount:i().length,totalReviews:r,mintsWithReviews:t.size,mintsWithNostrInfo:e.size,mintsWithHttpInfo:n.size}},exportData:function(){return{reviews:Array.from(t.entries()).map(([t,e])=>({url:t,reviews:e.map(t=>({eventId:t.eventId,pubkey:t.pubkey,created_at:t.created_at,rating:t.rating,comment:t.comment}))})),httpInfo:Array.from(n.entries()).map(([t,e])=>({url:t,info:e.info,error:e.error,fetchedAt:e.fetchedAt}))}},importData:function(t){if(t){if(Array.isArray(t.reviews))for(const{url:e,reviews:n}of t.reviews)if(Array.isArray(n))for(const t of n)r({...t,url:e});if(Array.isArray(t.httpInfo))for(const e of t.httpInfo)e.url&&s(e.url,e)}}}}}},484(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.validateObject=e.createHmacDrbg=e.bitMask=e.bitSet=e.bitGet=e.bitLen=e.utf8ToBytes=e.equalBytes=e.concatBytes=e.ensureBytes=e.numberToVarBytesBE=e.numberToBytesLE=e.numberToBytesBE=e.bytesToNumberLE=e.bytesToNumberBE=e.hexToBytes=e.hexToNumber=e.numberToHexUnpadded=e.bytesToHex=void 0;const n=BigInt(0),r=BigInt(1),o=BigInt(2),s=t=>t instanceof Uint8Array,i=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function a(t){if(!s(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=i[t[n]];return e}function c(t){const e=t.toString(16);return 1&e.length?`0${e}`:e}function u(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);return BigInt(""===t?"0":`0x${t}`)}function f(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let e=0;e<n.length;e++){const r=2*e,o=t.slice(r,r+2),s=Number.parseInt(o,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");n[e]=s}return n}function l(t,e){return f(t.toString(16).padStart(2*e,"0"))}function h(...t){const e=new Uint8Array(t.reduce((t,e)=>t+e.length,0));let n=0;return t.forEach(t=>{if(!s(t))throw new Error("Uint8Array expected");e.set(t,n),n+=t.length}),e}e.bytesToHex=a,e.numberToHexUnpadded=c,e.hexToNumber=u,e.hexToBytes=f,e.bytesToNumberBE=function(t){return u(a(t))},e.bytesToNumberLE=function(t){if(!s(t))throw new Error("Uint8Array expected");return u(a(Uint8Array.from(t).reverse()))},e.numberToBytesBE=l,e.numberToBytesLE=function(t,e){return l(t,e).reverse()},e.numberToVarBytesBE=function(t){return f(c(t))},e.ensureBytes=function(t,e,n){let r;if("string"==typeof e)try{r=f(e)}catch(n){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${n}`)}else{if(!s(e))throw new Error(`${t} must be hex string or Uint8Array`);r=Uint8Array.from(e)}const o=r.length;if("number"==typeof n&&o!==n)throw new Error(`${t} expected ${n} bytes, got ${o}`);return r},e.concatBytes=h,e.equalBytes=function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0},e.utf8ToBytes=function(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))},e.bitLen=function(t){let e;for(e=0;t>n;t>>=r,e+=1);return e},e.bitGet=function(t,e){return t>>BigInt(e)&r},e.bitSet=(t,e,o)=>t|(o?r:n)<<BigInt(e),e.bitMask=t=>(o<<BigInt(t-1))-r;const d=t=>new Uint8Array(t),p=t=>Uint8Array.from(t);e.createHmacDrbg=function(t,e,n){if("number"!=typeof t||t<2)throw new Error("hashLen must be a number");if("number"!=typeof e||e<2)throw new Error("qByteLen must be a number");if("function"!=typeof n)throw new Error("hmacFn must be a function");let r=d(t),o=d(t),s=0;const i=()=>{r.fill(1),o.fill(0),s=0},a=(...t)=>n(o,r,...t),c=(t=d())=>{o=a(p([0]),t),r=a(),0!==t.length&&(o=a(p([1]),t),r=a())},u=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let t=0;const n=[];for(;t<e;){r=a();const e=r.slice();n.push(e),t+=r.length}return h(...n)};return(t,e)=>{let n;for(i(),c(t);!(n=e(u()));)c();return i(),n}};const y={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,stringOrUint8Array:t=>"string"==typeof t||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};e.validateObject=function(t,e,n={}){const r=(e,n,r)=>{const o=y[n];if("function"!=typeof o)throw new Error(`Invalid validator "${n}", expected function`);const s=t[e];if(!(r&&void 0===s||o(s,t)))throw new Error(`Invalid param ${String(e)}=${s} (${typeof s}), expected ${n}`)};for(const[t,n]of Object.entries(e))r(t,n,!1);for(const[t,e]of Object.entries(n))r(t,e,!0);return t}},510(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.encodeToCurve=e.hashToCurve=e.schnorr=e.secp256k1=void 0;const r=n(696),o=n(130),s=n(967),i=n(705),a=n(484),c=n(761),u=n(562),f=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),l=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h=BigInt(1),d=BigInt(2),p=(t,e)=>(t+e/d)/e;function y(t){const e=f,n=BigInt(3),r=BigInt(6),o=BigInt(11),i=BigInt(22),a=BigInt(23),c=BigInt(44),u=BigInt(88),l=t*t*t%e,h=l*l*t%e,p=(0,s.pow2)(h,n,e)*h%e,y=(0,s.pow2)(p,n,e)*h%e,w=(0,s.pow2)(y,d,e)*l%e,m=(0,s.pow2)(w,o,e)*w%e,b=(0,s.pow2)(m,i,e)*m%e,v=(0,s.pow2)(b,c,e)*b%e,E=(0,s.pow2)(v,u,e)*v%e,B=(0,s.pow2)(E,c,e)*b%e,x=(0,s.pow2)(B,n,e)*h%e,A=(0,s.pow2)(x,a,e)*m%e,S=(0,s.pow2)(A,r,e)*l%e,T=(0,s.pow2)(S,d,e);if(!g.eql(g.sqr(T),t))throw new Error("Cannot find square root");return T}const g=(0,s.Field)(f,void 0,void 0,{sqrt:y});e.secp256k1=(0,u.createCurve)({a:BigInt(0),b:BigInt(7),Fp:g,n:l,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=l,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-h*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,a=BigInt("0x100000000000000000000000000000000"),c=p(i*t,e),u=p(-r*t,e);let f=(0,s.mod)(t-c*n-u*o,e),d=(0,s.mod)(-c*r-u*i,e);const y=f>a,g=d>a;if(y&&(f=e-f),g&&(d=e-d),f>a||d>a)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:y,k1:f,k2neg:g,k2:d}}}},r.sha256);const w=BigInt(0),m=t=>"bigint"==typeof t&&w<t&&t<f,b={};function v(t,...e){let n=b[t];if(void 0===n){const e=(0,r.sha256)(Uint8Array.from(t,t=>t.charCodeAt(0)));n=(0,a.concatBytes)(e,e),b[t]=n}return(0,r.sha256)((0,a.concatBytes)(n,...e))}const E=t=>t.toRawBytes(!0).slice(1),B=t=>(0,a.numberToBytesBE)(t,32),x=t=>(0,s.mod)(t,f),A=t=>(0,s.mod)(t,l),S=e.secp256k1.ProjectivePoint;function T(t){let n=e.secp256k1.utils.normPrivateKeyToScalar(t),r=S.fromPrivateKey(n);return{scalar:r.hasEvenY()?n:A(-n),bytes:E(r)}}function I(t){if(!m(t))throw new Error("bad x: need 0 < x < p");const e=x(t*t);let n=y(x(e*t+BigInt(7)));n%d!==w&&(n=x(-n));const r=new S(t,n,h);return r.assertValidity(),r}function O(...t){return A((0,a.bytesToNumberBE)(v("BIP0340/challenge",...t)))}function R(t,e,n){const r=(0,a.ensureBytes)("signature",t,64),o=(0,a.ensureBytes)("message",e),s=(0,a.ensureBytes)("publicKey",n,32);try{const t=I((0,a.bytesToNumberBE)(s)),e=(0,a.bytesToNumberBE)(r.subarray(0,32));if(!m(e))return!1;const n=(0,a.bytesToNumberBE)(r.subarray(32,64));if(!("bigint"==typeof(f=n)&&w<f&&f<l))return!1;const h=O(B(e),E(t),o),d=(i=t,c=n,u=A(-h),S.BASE.multiplyAndAddUnsafe(i,c,u));return!(!d||!d.hasEvenY()||d.toAffine().x!==e)}catch(t){return!1}var i,c,u,f}e.schnorr={getPublicKey:function(t){return T(t).bytes},sign:function(t,e,n=(0,o.randomBytes)(32)){const r=(0,a.ensureBytes)("message",t),{bytes:s,scalar:i}=T(e),c=(0,a.ensureBytes)("auxRand",n,32),u=B(i^(0,a.bytesToNumberBE)(v("BIP0340/aux",c))),f=v("BIP0340/nonce",u,s,r),l=A((0,a.bytesToNumberBE)(f));if(l===w)throw new Error("sign failed: k is zero");const{bytes:h,scalar:d}=T(l),p=O(h,s,r),y=new Uint8Array(64);if(y.set(h,0),y.set(B(A(d+p*i)),32),!R(y,r,s))throw new Error("sign: Invalid signature produced");return y},verify:R,utils:{randomPrivateKey:e.secp256k1.utils.randomPrivateKey,lift_x:I,pointToBytes:E,numberToBytesBE:a.numberToBytesBE,bytesToNumberBE:a.bytesToNumberBE,taggedHash:v,mod:s.mod}};const P=(()=>(0,c.isogenyMap)(g,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(t=>t.map(t=>BigInt(t)))))(),H=(()=>(0,i.mapToCurveSimpleSWU)(g,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:g.create(BigInt("-11"))}))(),L=(()=>(0,c.createHasher)(e.secp256k1.ProjectivePoint,t=>{const{x:e,y:n}=H(g.create(t[0]));return P(e,n)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:g.ORDER,m:1,k:128,expand:"xmd",hash:r.sha256}))();e.hashToCurve=L.hashToCurve,e.encodeToCurve=L.encodeToCurve},513(t){t.exports={parseRatingAndComment:function(t){if(!t||"string"!=typeof t)return{rating:null,comment:""};const e=t.match(/\s*\[(\d)\s*\/\s*5\]\s*(.*)$/s);if(!e)return{rating:null,comment:t.trim()};const n=parseInt(e[1],10),r=(e[2]||"").trim();return isNaN(n)||n<1||n>5?{rating:null,comment:r}:{rating:n,comment:r}}}},557(t,e){"use strict";function n(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function r(t){if("boolean"!=typeof t)throw new Error(`Expected boolean, not ${t}`)}function o(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function s(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");n(t.outputLen),n(t.blockLen)}function i(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function a(t,e){o(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}Object.defineProperty(e,"__esModule",{value:!0}),e.output=e.exists=e.hash=e.bytes=e.bool=e.number=void 0,e.number=n,e.bool=r,e.bytes=o,e.hash=s,e.exists=i,e.output=a;const c={number:n,bool:r,bytes:o,hash:s,exists:i,output:a};e.default=c},562(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createCurve=e.getHash=void 0;const r=n(788),o=n(130),s=n(705);function i(t){return{hash:t,hmac:(e,...n)=>(0,r.hmac)(t,e,(0,o.concatBytes)(...n)),randomBytes:o.randomBytes}}e.getHash=i,e.createCurve=function(t,e){const n=e=>(0,s.weierstrass)({...t,...i(e)});return Object.freeze({...n(e),create:n})}},620(t){async function e(t,e=1e4){if(!t||"string"!=typeof t||!t.startsWith("http"))return{url:t,info:null,error:!0,fetchedAt:Math.floor(Date.now()/1e3)};const n=`${t.replace(/\/$/,"")}/v1/info`,r=new AbortController,o=setTimeout(()=>r.abort(),e);try{const e=await fetch(n,{signal:r.signal,headers:{Accept:"application/json"}});return clearTimeout(o),e.ok?{url:t,info:await e.json(),error:!1,fetchedAt:Math.floor(Date.now()/1e3)}:{url:t,info:null,error:!0,fetchedAt:Math.floor(Date.now()/1e3)}}catch(e){return clearTimeout(o),{url:t,info:null,error:!0,fetchedAt:Math.floor(Date.now()/1e3)}}}t.exports={fetchMintInfo:e,fetchMintInfoBatch:async function(t,n={}){const{concurrency:r=20,delayMs:o=100,timeout:s=1e4,onResult:i}=n;if(!t||!Array.isArray(t)||0===t.length)return[];const a=[...new Set(t.filter(t=>"string"==typeof t))],c=[];let u=0;const f=t=>new Promise(e=>setTimeout(e,t)),l=Math.min(r,a.length),h=Array.from({length:l},()=>(async()=>{for(;;){const t=u++;if(t>=a.length)break;const n=a[t],r=await e(n,s);if(c.push(r),i)try{i(r)}catch{}t<a.length-1&&await f(o)}})());return await Promise.all(h),c},isCacheFresh:function(t,e=3600){return!(!t||!t.fetchedAt)&&Math.floor(Date.now()/1e3)-t.fetchedAt<e}}},623(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sha224=e.sha256=void 0;const r=n(915),o=n(175),s=(t,e,n)=>t&e^~t&n,i=(t,e,n)=>t&e^t&n^e&n,a=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),c=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),u=new Uint32Array(64);class f extends r.SHA2{constructor(){super(64,32,8,!1),this.A=0|c[0],this.B=0|c[1],this.C=0|c[2],this.D=0|c[3],this.E=0|c[4],this.F=0|c[5],this.G=0|c[6],this.H=0|c[7]}get(){const{A:t,B:e,C:n,D:r,E:o,F:s,G:i,H:a}=this;return[t,e,n,r,o,s,i,a]}set(t,e,n,r,o,s,i,a){this.A=0|t,this.B=0|e,this.C=0|n,this.D=0|r,this.E=0|o,this.F=0|s,this.G=0|i,this.H=0|a}process(t,e){for(let n=0;n<16;n++,e+=4)u[n]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=u[t-15],n=u[t-2],r=(0,o.rotr)(e,7)^(0,o.rotr)(e,18)^e>>>3,s=(0,o.rotr)(n,17)^(0,o.rotr)(n,19)^n>>>10;u[t]=s+u[t-7]+r+u[t-16]|0}let{A:n,B:r,C:c,D:f,E:l,F:h,G:d,H:p}=this;for(let t=0;t<64;t++){const e=p+((0,o.rotr)(l,6)^(0,o.rotr)(l,11)^(0,o.rotr)(l,25))+s(l,h,d)+a[t]+u[t]|0,y=((0,o.rotr)(n,2)^(0,o.rotr)(n,13)^(0,o.rotr)(n,22))+i(n,r,c)|0;p=d,d=h,h=l,l=f+e|0,f=c,c=r,r=n,n=e+y|0}n=n+this.A|0,r=r+this.B|0,c=c+this.C|0,f=f+this.D|0,l=l+this.E|0,h=h+this.F|0,d=d+this.G|0,p=p+this.H|0,this.set(n,r,c,f,l,h,d,p)}roundClean(){u.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class l extends f{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}e.sha256=(0,o.wrapConstructor)(()=>new f),e.sha224=(0,o.wrapConstructor)(()=>new l)},696(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sha224=e.sha256=void 0;const r=n(346),o=n(130),s=(t,e,n)=>t&e^~t&n,i=(t,e,n)=>t&e^t&n^e&n,a=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),c=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),u=new Uint32Array(64);class f extends r.SHA2{constructor(){super(64,32,8,!1),this.A=0|c[0],this.B=0|c[1],this.C=0|c[2],this.D=0|c[3],this.E=0|c[4],this.F=0|c[5],this.G=0|c[6],this.H=0|c[7]}get(){const{A:t,B:e,C:n,D:r,E:o,F:s,G:i,H:a}=this;return[t,e,n,r,o,s,i,a]}set(t,e,n,r,o,s,i,a){this.A=0|t,this.B=0|e,this.C=0|n,this.D=0|r,this.E=0|o,this.F=0|s,this.G=0|i,this.H=0|a}process(t,e){for(let n=0;n<16;n++,e+=4)u[n]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=u[t-15],n=u[t-2],r=(0,o.rotr)(e,7)^(0,o.rotr)(e,18)^e>>>3,s=(0,o.rotr)(n,17)^(0,o.rotr)(n,19)^n>>>10;u[t]=s+u[t-7]+r+u[t-16]|0}let{A:n,B:r,C:c,D:f,E:l,F:h,G:d,H:p}=this;for(let t=0;t<64;t++){const e=p+((0,o.rotr)(l,6)^(0,o.rotr)(l,11)^(0,o.rotr)(l,25))+s(l,h,d)+a[t]+u[t]|0,y=((0,o.rotr)(n,2)^(0,o.rotr)(n,13)^(0,o.rotr)(n,22))+i(n,r,c)|0;p=d,d=h,h=l,l=f+e|0,f=c,c=r,r=n,n=e+y|0}n=n+this.A|0,r=r+this.B|0,c=c+this.C|0,f=f+this.D|0,l=l+this.E|0,h=h+this.F|0,d=d+this.G|0,p=p+this.H|0,this.set(n,r,c,f,l,h,d,p)}roundClean(){u.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class l extends f{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}e.sha256=(0,o.wrapConstructor)(()=>new f),e.sha224=(0,o.wrapConstructor)(()=>new l)},705(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.mapToCurveSimpleSWU=e.SWUFpSqrtRatio=e.weierstrass=e.weierstrassPoints=e.DER=void 0;const r=n(967),o=n(484),s=n(484),i=n(422),{bytesToNumberBE:a,hexToBytes:c}=o;e.DER={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(t){const{Err:n}=e.DER;if(t.length<2||2!==t[0])throw new n("Invalid signature integer tag");const r=t[1],o=t.subarray(2,r+2);if(!r||o.length!==r)throw new n("Invalid signature integer: wrong length");if(128&o[0])throw new n("Invalid signature integer: negative");if(0===o[0]&&!(128&o[1]))throw new n("Invalid signature integer: unnecessary leading zero");return{d:a(o),l:t.subarray(r+2)}},toSig(t){const{Err:n}=e.DER,r="string"==typeof t?c(t):t;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let o=r.length;if(o<2||48!=r[0])throw new n("Invalid signature tag");if(r[1]!==o-2)throw new n("Invalid signature: incorrect length");const{d:s,l:i}=e.DER._parseInt(r.subarray(2)),{d:a,l:u}=e.DER._parseInt(i);if(u.length)throw new n("Invalid signature: left bytes after parsing");return{r:s,s:a}},hexFromSig(t){const e=t=>8&Number.parseInt(t[0],16)?"00"+t:t,n=t=>{const e=t.toString(16);return 1&e.length?`0${e}`:e},r=e(n(t.s)),o=e(n(t.r)),s=r.length/2,i=o.length/2,a=n(s),c=n(i);return`30${n(i+s+4)}02${c}${o}02${a}${r}`}};const u=BigInt(0),f=BigInt(1),l=BigInt(2),h=BigInt(3),d=BigInt(4);function p(t){const e=function(t){const e=(0,i.validateBasic)(t);o.validateObject(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:s}=e;if(n){if(!r.eql(s,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof n||"bigint"!=typeof n.beta||"function"!=typeof n.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}(t),{Fp:n}=e,a=e.toBytes||((t,e,r)=>{const s=e.toAffine();return o.concatBytes(Uint8Array.from([4]),n.toBytes(s.x),n.toBytes(s.y))}),c=e.fromBytes||(t=>{const e=t.subarray(1);return{x:n.fromBytes(e.subarray(0,n.BYTES)),y:n.fromBytes(e.subarray(n.BYTES,2*n.BYTES))}});function l(t){const{a:r,b:o}=e,s=n.sqr(t),i=n.mul(s,t);return n.add(n.add(i,n.mul(t,r)),o)}if(!n.eql(n.sqr(e.Gy),l(e.Gx)))throw new Error("bad generator point: equation left != right");function d(t){return"bigint"==typeof t&&u<t&&t<e.n}function p(t){if(!d(t))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function y(t){const{allowedPrivateKeyLengths:n,nByteLength:i,wrapPrivateKey:a,n:c}=e;if(n&&"bigint"!=typeof t){if(t instanceof Uint8Array&&(t=o.bytesToHex(t)),"string"!=typeof t||!n.includes(t.length))throw new Error("Invalid key");t=t.padStart(2*i,"0")}let u;try{u="bigint"==typeof t?t:o.bytesToNumberBE((0,s.ensureBytes)("private key",t,i))}catch(e){throw new Error(`private key must be ${i} bytes, hex or bigint, not ${typeof t}`)}return a&&(u=r.mod(u,c)),p(u),u}const g=new Map;function w(t){if(!(t instanceof m))throw new Error("ProjectivePoint expected")}class m{constructor(t,e,r){if(this.px=t,this.py=e,this.pz=r,null==t||!n.isValid(t))throw new Error("x required");if(null==e||!n.isValid(e))throw new Error("y required");if(null==r||!n.isValid(r))throw new Error("z required")}static fromAffine(t){const{x:e,y:r}=t||{};if(!t||!n.isValid(e)||!n.isValid(r))throw new Error("invalid affine point");if(t instanceof m)throw new Error("projective point not allowed");const o=t=>n.eql(t,n.ZERO);return o(e)&&o(r)?m.ZERO:new m(e,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){const e=n.invertBatch(t.map(t=>t.pz));return t.map((t,n)=>t.toAffine(e[n])).map(m.fromAffine)}static fromHex(t){const e=m.fromAffine(c((0,s.ensureBytes)("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){return m.BASE.multiply(y(t))}_setWindowSize(t){this._WINDOW_SIZE=t,g.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:t,y:r}=this.toAffine();if(!n.isValid(t)||!n.isValid(r))throw new Error("bad point: x or y not FE");const o=n.sqr(r),s=l(t);if(!n.eql(o,s))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:t}=this.toAffine();if(n.isOdd)return!n.isOdd(t);throw new Error("Field doesn't support isOdd")}equals(t){w(t);const{px:e,py:r,pz:o}=this,{px:s,py:i,pz:a}=t,c=n.eql(n.mul(e,a),n.mul(s,o)),u=n.eql(n.mul(r,a),n.mul(i,o));return c&&u}negate(){return new m(this.px,n.neg(this.py),this.pz)}double(){const{a:t,b:r}=e,o=n.mul(r,h),{px:s,py:i,pz:a}=this;let c=n.ZERO,u=n.ZERO,f=n.ZERO,l=n.mul(s,s),d=n.mul(i,i),p=n.mul(a,a),y=n.mul(s,i);return y=n.add(y,y),f=n.mul(s,a),f=n.add(f,f),c=n.mul(t,f),u=n.mul(o,p),u=n.add(c,u),c=n.sub(d,u),u=n.add(d,u),u=n.mul(c,u),c=n.mul(y,c),f=n.mul(o,f),p=n.mul(t,p),y=n.sub(l,p),y=n.mul(t,y),y=n.add(y,f),f=n.add(l,l),l=n.add(f,l),l=n.add(l,p),l=n.mul(l,y),u=n.add(u,l),p=n.mul(i,a),p=n.add(p,p),l=n.mul(p,y),c=n.sub(c,l),f=n.mul(p,d),f=n.add(f,f),f=n.add(f,f),new m(c,u,f)}add(t){w(t);const{px:r,py:o,pz:s}=this,{px:i,py:a,pz:c}=t;let u=n.ZERO,f=n.ZERO,l=n.ZERO;const d=e.a,p=n.mul(e.b,h);let y=n.mul(r,i),g=n.mul(o,a),b=n.mul(s,c),v=n.add(r,o),E=n.add(i,a);v=n.mul(v,E),E=n.add(y,g),v=n.sub(v,E),E=n.add(r,s);let B=n.add(i,c);return E=n.mul(E,B),B=n.add(y,b),E=n.sub(E,B),B=n.add(o,s),u=n.add(a,c),B=n.mul(B,u),u=n.add(g,b),B=n.sub(B,u),l=n.mul(d,E),u=n.mul(p,b),l=n.add(u,l),u=n.sub(g,l),l=n.add(g,l),f=n.mul(u,l),g=n.add(y,y),g=n.add(g,y),b=n.mul(d,b),E=n.mul(p,E),g=n.add(g,b),b=n.sub(y,b),b=n.mul(d,b),E=n.add(E,b),y=n.mul(g,E),f=n.add(f,y),y=n.mul(B,E),u=n.mul(v,u),u=n.sub(u,y),y=n.mul(v,g),l=n.mul(B,l),l=n.add(l,y),new m(u,f,l)}subtract(t){return this.add(t.negate())}is0(){return this.equals(m.ZERO)}wNAF(t){return v.wNAFCached(this,g,t,t=>{const e=n.invertBatch(t.map(t=>t.pz));return t.map((t,n)=>t.toAffine(e[n])).map(m.fromAffine)})}multiplyUnsafe(t){const r=m.ZERO;if(t===u)return r;if(p(t),t===f)return this;const{endo:o}=e;if(!o)return v.unsafeLadder(this,t);let{k1neg:s,k1:i,k2neg:a,k2:c}=o.splitScalar(t),l=r,h=r,d=this;for(;i>u||c>u;)i&f&&(l=l.add(d)),c&f&&(h=h.add(d)),d=d.double(),i>>=f,c>>=f;return s&&(l=l.negate()),a&&(h=h.negate()),h=new m(n.mul(h.px,o.beta),h.py,h.pz),l.add(h)}multiply(t){p(t);let r,o,s=t;const{endo:i}=e;if(i){const{k1neg:t,k1:e,k2neg:a,k2:c}=i.splitScalar(s);let{p:u,f}=this.wNAF(e),{p:l,f:h}=this.wNAF(c);u=v.constTimeNegate(t,u),l=v.constTimeNegate(a,l),l=new m(n.mul(l.px,i.beta),l.py,l.pz),r=u.add(l),o=f.add(h)}else{const{p:t,f:e}=this.wNAF(s);r=t,o=e}return m.normalizeZ([r,o])[0]}multiplyAndAddUnsafe(t,e,n){const r=m.BASE,o=(t,e)=>e!==u&&e!==f&&t.equals(r)?t.multiply(e):t.multiplyUnsafe(e),s=o(this,e).add(o(t,n));return s.is0()?void 0:s}toAffine(t){const{px:e,py:r,pz:o}=this,s=this.is0();null==t&&(t=s?n.ONE:n.inv(o));const i=n.mul(e,t),a=n.mul(r,t),c=n.mul(o,t);if(s)return{x:n.ZERO,y:n.ZERO};if(!n.eql(c,n.ONE))throw new Error("invZ was invalid");return{x:i,y:a}}isTorsionFree(){const{h:t,isTorsionFree:n}=e;if(t===f)return!0;if(n)return n(m,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:t,clearCofactor:n}=e;return t===f?this:n?n(m,this):this.multiplyUnsafe(e.h)}toRawBytes(t=!0){return this.assertValidity(),a(m,this,t)}toHex(t=!0){return o.bytesToHex(this.toRawBytes(t))}}m.BASE=new m(e.Gx,e.Gy,n.ONE),m.ZERO=new m(n.ZERO,n.ONE,n.ZERO);const b=e.nBitLength,v=(0,i.wNAF)(m,e.endo?Math.ceil(b/2):b);return{CURVE:e,ProjectivePoint:m,normPrivateKeyToScalar:y,weierstrassEquation:l,isWithinCurveOrder:d}}function y(t,e){const n=t.ORDER;let r=u;for(let t=n-f;t%l===u;t/=l)r+=f;const o=r,s=l<<o-f-f,i=s*l,a=(n-f)/i,c=(a-f)/l,p=i-f,y=s,g=t.pow(e,a),w=t.pow(e,(a+f)/l);let m=(e,n)=>{let r=g,s=t.pow(n,p),i=t.sqr(s);i=t.mul(i,n);let a=t.mul(e,i);a=t.pow(a,c),a=t.mul(a,s),s=t.mul(a,n),i=t.mul(a,e);let u=t.mul(i,s);a=t.pow(u,y);let h=t.eql(a,t.ONE);s=t.mul(i,w),a=t.mul(u,r),i=t.cmov(s,i,h),u=t.cmov(a,u,h);for(let e=o;e>f;e--){let n=e-l;n=l<<n-f;let o=t.pow(u,n);const a=t.eql(o,t.ONE);s=t.mul(i,r),r=t.mul(r,r),o=t.mul(u,r),i=t.cmov(s,i,a),u=t.cmov(o,u,a)}return{isValid:h,value:i}};if(t.ORDER%d===h){const n=(t.ORDER-h)/d,r=t.sqrt(t.neg(e));m=(e,o)=>{let s=t.sqr(o);const i=t.mul(e,o);s=t.mul(s,i);let a=t.pow(s,n);a=t.mul(a,i);const c=t.mul(a,r),u=t.mul(t.sqr(a),o),f=t.eql(u,e);return{isValid:f,value:t.cmov(c,a,f)}}}return m}e.weierstrassPoints=p,e.weierstrass=function(t){const n=function(t){const e=(0,i.validateBasic)(t);return o.validateObject(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}(t),{Fp:a,n:c}=n,l=a.BYTES+1,h=2*a.BYTES+1;function d(t){return r.mod(t,c)}function y(t){return r.invert(t,c)}const{ProjectivePoint:g,normPrivateKeyToScalar:w,weierstrassEquation:m,isWithinCurveOrder:b}=p({...n,toBytes(t,e,n){const r=e.toAffine(),s=a.toBytes(r.x),i=o.concatBytes;return n?i(Uint8Array.from([e.hasEvenY()?2:3]),s):i(Uint8Array.from([4]),s,a.toBytes(r.y))},fromBytes(t){const e=t.length,n=t[0],r=t.subarray(1);if(e!==l||2!==n&&3!==n){if(e===h&&4===n)return{x:a.fromBytes(r.subarray(0,a.BYTES)),y:a.fromBytes(r.subarray(a.BYTES,2*a.BYTES))};throw new Error(`Point of length ${e} was invalid. Expected ${l} compressed bytes or ${h} uncompressed bytes`)}{const t=o.bytesToNumberBE(r);if(!(u<(s=t)&&s<a.ORDER))throw new Error("Point is not on curve");const e=m(t);let i=a.sqrt(e);return!(1&~n)!=((i&f)===f)&&(i=a.neg(i)),{x:t,y:i}}var s}}),v=t=>o.bytesToHex(o.numberToBytesBE(t,n.nByteLength));function E(t){return t>c>>f}const B=(t,e,n)=>o.bytesToNumberBE(t.slice(e,n));class x{constructor(t,e,n){this.r=t,this.s=e,this.recovery=n,this.assertValidity()}static fromCompact(t){const e=n.nByteLength;return t=(0,s.ensureBytes)("compactSignature",t,2*e),new x(B(t,0,e),B(t,e,2*e))}static fromDER(t){const{r:n,s:r}=e.DER.toSig((0,s.ensureBytes)("DER",t));return new x(n,r)}assertValidity(){if(!b(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!b(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(t){return new x(this.r,this.s,t)}recoverPublicKey(t){const{r:e,s:r,recovery:o}=this,i=I((0,s.ensureBytes)("msgHash",t));if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");const c=2===o||3===o?e+n.n:e;if(c>=a.ORDER)throw new Error("recovery id 2 or 3 invalid");const u=1&o?"03":"02",f=g.fromHex(u+v(c)),l=y(c),h=d(-i*l),p=d(r*l),w=g.BASE.multiplyAndAddUnsafe(f,h,p);if(!w)throw new Error("point at infinify");return w.assertValidity(),w}hasHighS(){return E(this.s)}normalizeS(){return this.hasHighS()?new x(this.r,d(-this.s),this.recovery):this}toDERRawBytes(){return o.hexToBytes(this.toDERHex())}toDERHex(){return e.DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return o.hexToBytes(this.toCompactHex())}toCompactHex(){return v(this.r)+v(this.s)}}const A={isValidPrivateKey(t){try{return w(t),!0}catch(t){return!1}},normPrivateKeyToScalar:w,randomPrivateKey:()=>{const t=r.getMinHashLength(n.n);return r.mapHashToField(n.randomBytes(t),n.n)},precompute:(t=8,e=g.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)};function S(t){const e=t instanceof Uint8Array,n="string"==typeof t,r=(e||n)&&t.length;return e?r===l||r===h:n?r===2*l||r===2*h:t instanceof g}const T=n.bits2int||function(t){const e=o.bytesToNumberBE(t),r=8*t.length-n.nBitLength;return r>0?e>>BigInt(r):e},I=n.bits2int_modN||function(t){return d(T(t))},O=o.bitMask(n.nBitLength);function R(t){if("bigint"!=typeof t)throw new Error("bigint expected");if(!(u<=t&&t<O))throw new Error(`bigint expected < 2^${n.nBitLength}`);return o.numberToBytesBE(t,n.nByteLength)}const P={lowS:n.lowS,prehash:!1},H={lowS:n.lowS,prehash:!1};return g.BASE._setWindowSize(8),{CURVE:n,getPublicKey:function(t,e=!0){return g.fromPrivateKey(t).toRawBytes(e)},getSharedSecret:function(t,e,n=!0){if(S(t))throw new Error("first arg must be private key");if(!S(e))throw new Error("second arg must be public key");return g.fromHex(e).multiply(w(t)).toRawBytes(n)},sign:function(t,e,r=P){const{seed:i,k2sig:c}=function(t,e,r=P){if(["recovered","canonical"].some(t=>t in r))throw new Error("sign() legacy options not supported");const{hash:i,randomBytes:c}=n;let{lowS:l,prehash:h,extraEntropy:p}=r;null==l&&(l=!0),t=(0,s.ensureBytes)("msgHash",t),h&&(t=(0,s.ensureBytes)("prehashed msgHash",i(t)));const m=I(t),v=w(e),B=[R(v),R(m)];if(null!=p){const t=!0===p?c(a.BYTES):p;B.push((0,s.ensureBytes)("extraEntropy",t))}const A=o.concatBytes(...B),S=m;return{seed:A,k2sig:function(t){const e=T(t);if(!b(e))return;const n=y(e),r=g.BASE.multiply(e).toAffine(),o=d(r.x);if(o===u)return;const s=d(n*d(S+o*v));if(s===u)return;let i=(r.x===o?0:2)|Number(r.y&f),a=s;return l&&E(s)&&(a=function(t){return E(t)?d(-t):t}(s),i^=1),new x(o,a,i)}}}(t,e,r),l=n;return o.createHmacDrbg(l.hash.outputLen,l.nByteLength,l.hmac)(i,c)},verify:function(t,r,o,i=H){const a=t;if(r=(0,s.ensureBytes)("msgHash",r),o=(0,s.ensureBytes)("publicKey",o),"strict"in i)throw new Error("options.strict was renamed to lowS");const{lowS:c,prehash:u}=i;let f,l;try{if("string"==typeof a||a instanceof Uint8Array)try{f=x.fromDER(a)}catch(t){if(!(t instanceof e.DER.Err))throw t;f=x.fromCompact(a)}else{if("object"!=typeof a||"bigint"!=typeof a.r||"bigint"!=typeof a.s)throw new Error("PARSE");{const{r:t,s:e}=a;f=new x(t,e)}}l=g.fromHex(o)}catch(t){if("PARSE"===t.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(c&&f.hasHighS())return!1;u&&(r=n.hash(r));const{r:h,s:p}=f,w=I(r),m=y(p),b=d(w*m),v=d(h*m),E=g.BASE.multiplyAndAddUnsafe(l,b,v)?.toAffine();return!!E&&d(E.x)===h},ProjectivePoint:g,Signature:x,utils:A}},e.SWUFpSqrtRatio=y,e.mapToCurveSimpleSWU=function(t,e){if(r.validateField(t),!t.isValid(e.A)||!t.isValid(e.B)||!t.isValid(e.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const n=y(t,e.Z);if(!t.isOdd)throw new Error("Fp.isOdd is not implemented!");return r=>{let o,s,i,a,c,u,f,l;o=t.sqr(r),o=t.mul(o,e.Z),s=t.sqr(o),s=t.add(s,o),i=t.add(s,t.ONE),i=t.mul(i,e.B),a=t.cmov(e.Z,t.neg(s),!t.eql(s,t.ZERO)),a=t.mul(a,e.A),s=t.sqr(i),u=t.sqr(a),c=t.mul(u,e.A),s=t.add(s,c),s=t.mul(s,i),u=t.mul(u,a),c=t.mul(u,e.B),s=t.add(s,c),f=t.mul(o,i);const{isValid:h,value:d}=n(s,u);l=t.mul(o,r),l=t.mul(l,d),f=t.cmov(f,i,h),l=t.cmov(l,d,h);const p=t.isOdd(r)===t.isOdd(l);return l=t.cmov(t.neg(l),l,p),f=t.div(f,a),{x:f,y:l}}}},761(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createHasher=e.isogenyMap=e.hash_to_field=e.expand_message_xof=e.expand_message_xmd=void 0;const r=n(967),o=n(484),s=o.bytesToNumberBE;function i(t,e){if(t<0||t>=1<<8*e)throw new Error(`bad I2OSP call: value=${t} length=${e}`);const n=Array.from({length:e}).fill(0);for(let r=e-1;r>=0;r--)n[r]=255&t,t>>>=8;return new Uint8Array(n)}function a(t,e){const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t[r]^e[r];return n}function c(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected")}function u(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function f(t,e,n,r){c(t),c(e),u(n),e.length>255&&(e=r((0,o.concatBytes)((0,o.utf8ToBytes)("H2C-OVERSIZE-DST-"),e)));const{outputLen:s,blockLen:f}=r,l=Math.ceil(n/s);if(l>255)throw new Error("Invalid xmd length");const h=(0,o.concatBytes)(e,i(e.length,1)),d=i(0,f),p=i(n,2),y=new Array(l),g=r((0,o.concatBytes)(d,t,p,i(0,1),h));y[0]=r((0,o.concatBytes)(g,i(1,1),h));for(let t=1;t<=l;t++){const e=[a(g,y[t-1]),i(t+1,1),h];y[t]=r((0,o.concatBytes)(...e))}return(0,o.concatBytes)(...y).slice(0,n)}function l(t,e,n,r,s){if(c(t),c(e),u(n),e.length>255){const t=Math.ceil(2*r/8);e=s.create({dkLen:t}).update((0,o.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(e).digest()}if(n>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return s.create({dkLen:n}).update(t).update(i(n,2)).update(e).update(i(e.length,1)).digest()}function h(t,e,n){(0,o.validateObject)(n,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:i,k:a,m:h,hash:d,expand:p,DST:y}=n;c(t),u(e);const g=function(t){if(t instanceof Uint8Array)return t;if("string"==typeof t)return(0,o.utf8ToBytes)(t);throw new Error("DST must be Uint8Array or string")}(y),w=i.toString(2).length,m=Math.ceil((w+a)/8),b=e*h*m;let v;if("xmd"===p)v=f(t,g,b,d);else if("xof"===p)v=l(t,g,b,a,d);else{if("_internal_pass"!==p)throw new Error('expand must be "xmd" or "xof"');v=t}const E=new Array(e);for(let t=0;t<e;t++){const e=new Array(h);for(let n=0;n<h;n++){const o=m*(n+t*h),a=v.subarray(o,o+m);e[n]=(0,r.mod)(s(a),i)}E[t]=e}return E}e.expand_message_xmd=f,e.expand_message_xof=l,e.hash_to_field=h,e.isogenyMap=function(t,e){const n=e.map(t=>Array.from(t).reverse());return(e,r)=>{const[o,s,i,a]=n.map(n=>n.reduce((n,r)=>t.add(t.mul(n,e),r)));return e=t.div(o,s),r=t.mul(r,t.div(i,a)),{x:e,y:r}}},e.createHasher=function(t,e,n){if("function"!=typeof e)throw new Error("mapToCurve() must be defined");return{hashToCurve(r,o){const s=h(r,2,{...n,DST:n.DST,...o}),i=t.fromAffine(e(s[0])),a=t.fromAffine(e(s[1])),c=i.add(a).clearCofactor();return c.assertValidity(),c},encodeToCurve(r,o){const s=h(r,1,{...n,DST:n.encodeDST,...o}),i=t.fromAffine(e(s[0])).clearCofactor();return i.assertValidity(),i}}}},764(t,e){"use strict";function n(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function r(t){if("boolean"!=typeof t)throw new Error(`Expected boolean, not ${t}`)}function o(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function s(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");n(t.outputLen),n(t.blockLen)}function i(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function a(t,e){o(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}Object.defineProperty(e,"__esModule",{value:!0}),e.output=e.exists=e.hash=e.bytes=e.bool=e.number=void 0,e.number=n,e.bool=r,e.bytes=o,e.hash=s,e.exists=i,e.output=a;const c={number:n,bool:r,bytes:o,hash:s,exists:i,output:a};e.default=c},788(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.hmac=e.HMAC=void 0;const r=n(764),o=n(130);class s extends o.Hash{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,(0,r.hash)(t);const n=(0,o.toBytes)(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?t.create().update(n).digest():n);for(let t=0;t<i.length;t++)i[t]^=54;this.iHash.update(i),this.oHash=t.create();for(let t=0;t<i.length;t++)i[t]^=106;this.oHash.update(i),i.fill(0)}update(t){return(0,r.exists)(this),this.iHash.update(t),this}digestInto(t){(0,r.exists)(this),(0,r.bytes)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:n,finished:r,destroyed:o,blockLen:s,outputLen:i}=this;return t.finished=r,t.destroyed=o,t.blockLen=s,t.outputLen=i,t.oHash=e._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}e.HMAC=s,e.hmac=(t,e,n)=>new s(t,e).update(n).digest(),e.hmac.create=(t,e)=>new s(t,e)},903(t,e,n){const{SimplePool:r}=n(29),{parseRatingAndComment:o}=n(513),s=38172,i=38e3,a=["wss://relay.damus.io","wss://relay.8333.space/","wss://nos.lol","wss://relay.primal.net"];function c(t){if(!t||t.kind!==s)return null;const e=t.tags.find(t=>"u"===t[0]&&("cashu"===t[2]||t.length>=2));if(!e||"string"!=typeof e[1]||!e[1].startsWith("http"))return null;let n;try{n=t.content?JSON.parse(t.content):void 0}catch{n=void 0}const r=t.tags.find(t=>"d"===t[0]);return{url:e[1],pubkey:t.pubkey,d:r?r[1]:"",content:n,created_at:t.created_at||0,raw:t}}function u(t){if(!t||t.kind!==i)return[];const e=t.tags.find(t=>"k"===t[0]);if(!e||"38172"!==e[1])return[];const n=t.tags.filter(t=>"u"===t[0]&&("cashu"===t[2]||t.length>=2));if(!n.length)return[];const{rating:r,comment:s}=o(t.content||""),a=[];for(const e of n){const n=e[1];"string"==typeof n&&n.startsWith("http")&&a.push({eventId:t.id,pubkey:t.pubkey,created_at:t.created_at||0,rating:r,comment:s,url:n,raw:t})}return a}t.exports={createNostrClient:function(t={}){const e=t.relays||a,n=t.timeout||1e4,o=new r;return{fetchMintInfoEvents:async function(t=5e3){const r={kinds:[s],limit:t};return(await o.querySync(e,r,{timeout:n})).map(c).filter(Boolean)},fetchReviewEvents:async function(t=5e3){const r={kinds:[i],"#k":["38172"],limit:t};return(await o.querySync(e,r,{timeout:n})).flatMap(u).filter(Boolean)},fetchReviewsForUrl:async function(t,r=5e3){if(!t||"string"!=typeof t||!t.startsWith("http"))return[];const s={kinds:[i],"#k":["38172"],"#u":[t],limit:r};return(await o.querySync(e,s,{timeout:n})).flatMap(u).filter(Boolean)},fetchMintInfoForUrl:async function(t,r=1e3){if(!t||"string"!=typeof t||!t.startsWith("http"))return[];const i={kinds:[s],"#u":[t],limit:r};return(await o.querySync(e,i,{timeout:n})).map(c).filter(Boolean)},subscribeMintInfo:function(t){const n={kinds:[s]};return o.subscribeMany(e,n,{onevent(e){const n=c(e);n&&t.onEvent&&t.onEvent(n,e)},oneose(){t.onEose&&t.onEose()}})},subscribeReviews:function(t){const n={kinds:[i],"#k":["38172"]};return o.subscribeMany(e,n,{onevent(e){const n=u(e);if(n.length>0&&t.onEvent)for(const r of n)t.onEvent(r,e)},oneose(){t.onEose&&t.onEose()}})},close:function(){o.close(e)},pool:o,relays:e}},parseMintInfoEvent:c,parseReviewEvent:u,DEFAULT_RELAYS:a,MINT_INFO_KIND:s,REVIEW_KIND:i}},915(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SHA2=void 0;const r=n(557),o=n(175);class s extends o.Hash{constructor(t,e,n,r){super(),this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,o.createView)(this.buffer)}update(t){r.default.exists(this);const{view:e,buffer:n,blockLen:s}=this,i=(t=(0,o.toBytes)(t)).length;for(let r=0;r<i;){const a=Math.min(s-this.pos,i-r);if(a===s){const e=(0,o.createView)(t);for(;s<=i-r;r+=s)this.process(e,r);continue}n.set(t.subarray(r,r+a),this.pos),this.pos+=a,r+=a,this.pos===s&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){r.default.exists(this),r.default.output(t,this),this.finished=!0;const{buffer:e,view:n,blockLen:s,isLE:i}=this;let{pos:a}=this;e[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>s-a&&(this.process(n,0),a=0);for(let t=a;t<s;t++)e[t]=0;!function(t,e,n,r){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,n,r);const o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),a=Number(n&s),c=r?4:0,u=r?0:4;t.setUint32(e+c,i,r),t.setUint32(e+u,a,r)}(n,s-8,BigInt(8*this.length),i),this.process(n,0);const c=(0,o.createView)(t),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=u/4,l=this.get();if(f>l.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<f;t++)c.setUint32(4*t,l[t],i)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:n,length:r,finished:o,destroyed:s,pos:i}=this;return t.length=r,t.pos=i,t.finished=o,t.destroyed=s,r%e&&t.buffer.set(n),t}}e.SHA2=s},967(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.mapHashToField=e.getMinHashLength=e.getFieldBytesLength=e.hashToPrivateScalar=e.FpSqrtEven=e.FpSqrtOdd=e.Field=e.nLength=e.FpIsSquare=e.FpDiv=e.FpInvertBatch=e.FpPow=e.validateField=e.isNegativeLE=e.FpSqrt=e.tonelliShanks=e.invert=e.pow2=e.pow=e.mod=void 0;const r=n(484),o=BigInt(0),s=BigInt(1),i=BigInt(2),a=BigInt(3),c=BigInt(4),u=BigInt(5),f=BigInt(8);function l(t,e){const n=t%e;return n>=o?n:e+n}function h(t,e,n){if(n<=o||e<o)throw new Error("Expected power/modulo > 0");if(n===s)return o;let r=s;for(;e>o;)e&s&&(r=r*t%n),t=t*t%n,e>>=s;return r}function d(t,e){if(t===o||e<=o)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let n=l(t,e),r=e,i=o,a=s,c=s,u=o;for(;n!==o;){const t=r/n,e=r%n,o=i-c*t,s=a-u*t;r=n,n=e,i=c,a=u,c=o,u=s}if(r!==s)throw new Error("invert: does not exist");return l(i,e)}function p(t){const e=(t-s)/i;let n,r,a;for(n=t-s,r=0;n%i===o;n/=i,r++);for(a=i;a<t&&h(a,e,t)!==t-s;a++);if(1===r){const e=(t+s)/c;return function(t,n){const r=t.pow(n,e);if(!t.eql(t.sqr(r),n))throw new Error("Cannot find square root");return r}}const u=(n+s)/i;return function(t,o){if(t.pow(o,e)===t.neg(t.ONE))throw new Error("Cannot find square root");let i=r,c=t.pow(t.mul(t.ONE,a),n),f=t.pow(o,u),l=t.pow(o,n);for(;!t.eql(l,t.ONE);){if(t.eql(l,t.ZERO))return t.ZERO;let e=1;for(let n=t.sqr(l);e<i&&!t.eql(n,t.ONE);e++)n=t.sqr(n);const n=t.pow(c,s<<BigInt(i-e-1));c=t.sqr(n),f=t.mul(f,n),l=t.mul(l,c),i=e}return f}}function y(t){if(t%c===a){const e=(t+s)/c;return function(t,n){const r=t.pow(n,e);if(!t.eql(t.sqr(r),n))throw new Error("Cannot find square root");return r}}if(t%f===u){const e=(t-u)/f;return function(t,n){const r=t.mul(n,i),o=t.pow(r,e),s=t.mul(n,o),a=t.mul(t.mul(s,i),o),c=t.mul(s,t.sub(a,t.ONE));if(!t.eql(t.sqr(c),n))throw new Error("Cannot find square root");return c}}return p(t)}BigInt(9),BigInt(16),e.mod=l,e.pow=h,e.pow2=function(t,e,n){let r=t;for(;e-- >o;)r*=r,r%=n;return r},e.invert=d,e.tonelliShanks=p,e.FpSqrt=y,e.isNegativeLE=(t,e)=>(l(t,e)&s)===s;const g=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function w(t,e,n){if(n<o)throw new Error("Expected power > 0");if(n===o)return t.ONE;if(n===s)return e;let r=t.ONE,i=e;for(;n>o;)n&s&&(r=t.mul(r,i)),i=t.sqr(i),n>>=s;return r}function m(t,e){const n=new Array(e.length),r=e.reduce((e,r,o)=>t.is0(r)?e:(n[o]=e,t.mul(e,r)),t.ONE),o=t.inv(r);return e.reduceRight((e,r,o)=>t.is0(r)?e:(n[o]=t.mul(e,n[o]),t.mul(e,r)),o),n}function b(t,e){const n=void 0!==e?e:t.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function v(t){if("bigint"!=typeof t)throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function E(t){const e=v(t);return e+Math.ceil(e/2)}e.validateField=function(t){const e=g.reduce((t,e)=>(t[e]="function",t),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});return(0,r.validateObject)(t,e)},e.FpPow=w,e.FpInvertBatch=m,e.FpDiv=function(t,e,n){return t.mul(e,"bigint"==typeof n?d(n,t.ORDER):t.inv(n))},e.FpIsSquare=function(t){const e=(t.ORDER-s)/i;return n=>{const r=t.pow(n,e);return t.eql(r,t.ZERO)||t.eql(r,t.ONE)}},e.nLength=b,e.Field=function(t,e,n=!1,i={}){if(t<=o)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:a,nByteLength:c}=b(t,e);if(c>2048)throw new Error("Field lengths over 2048 bytes are not supported");const u=y(t),f=Object.freeze({ORDER:t,BITS:a,BYTES:c,MASK:(0,r.bitMask)(a),ZERO:o,ONE:s,create:e=>l(e,t),isValid:e=>{if("bigint"!=typeof e)throw new Error("Invalid field element: expected bigint, got "+typeof e);return o<=e&&e<t},is0:t=>t===o,isOdd:t=>(t&s)===s,neg:e=>l(-e,t),eql:(t,e)=>t===e,sqr:e=>l(e*e,t),add:(e,n)=>l(e+n,t),sub:(e,n)=>l(e-n,t),mul:(e,n)=>l(e*n,t),pow:(t,e)=>w(f,t,e),div:(e,n)=>l(e*d(n,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>d(e,t),sqrt:i.sqrt||(t=>u(f,t)),invertBatch:t=>m(f,t),cmov:(t,e,n)=>n?e:t,toBytes:t=>n?(0,r.numberToBytesLE)(t,c):(0,r.numberToBytesBE)(t,c),fromBytes:t=>{if(t.length!==c)throw new Error(`Fp.fromBytes: expected ${c}, got ${t.length}`);return n?(0,r.bytesToNumberLE)(t):(0,r.bytesToNumberBE)(t)}});return Object.freeze(f)},e.FpSqrtOdd=function(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");const n=t.sqrt(e);return t.isOdd(n)?n:t.neg(n)},e.FpSqrtEven=function(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");const n=t.sqrt(e);return t.isOdd(n)?t.neg(n):n},e.hashToPrivateScalar=function(t,e,n=!1){const o=(t=(0,r.ensureBytes)("privateHash",t)).length,i=b(e).nByteLength+8;if(i<24||o<i||o>1024)throw new Error(`hashToPrivateScalar: expected ${i}-1024 bytes of input, got ${o}`);return l(n?(0,r.bytesToNumberLE)(t):(0,r.bytesToNumberBE)(t),e-s)+s},e.getFieldBytesLength=v,e.getMinHashLength=E,e.mapHashToField=function(t,e,n=!1){const o=t.length,i=v(e),a=E(e);if(o<16||o<a||o>1024)throw new Error(`expected ${a}-1024 bytes of input, got ${o}`);const c=l(n?(0,r.bytesToNumberBE)(t):(0,r.bytesToNumberLE)(t),e-s)+s;return n?(0,r.numberToBytesLE)(c,i):(0,r.numberToBytesBE)(c,i)}},976(t){t.exports={createStorage:function(){if("undefined"==typeof indexedDB)return null;let t=null,e=null;function n(){return e||(e=new Promise((e,n)=>{const r=indexedDB.open("mintDiscovery",1);r.onerror=()=>n(r.error),r.onsuccess=()=>{t=r.result,e(t)},r.onupgradeneeded=t=>{const e=t.target.result;if(!e.objectStoreNames.contains("reviews")){const t=e.createObjectStore("reviews",{keyPath:"eventId"});t.createIndex("url","url",{unique:!1}),t.createIndex("created_at","created_at",{unique:!1})}e.objectStoreNames.contains("httpInfo")||e.createObjectStore("httpInfo",{keyPath:"url"}),e.objectStoreNames.contains("mintInfo")||e.createObjectStore("mintInfo",{keyPath:"id",autoIncrement:!0}).createIndex("url","url",{unique:!1})}}),e)}async function r(t){const e=await n();return new Promise((n,r)=>{const o=e.transaction("httpInfo","readonly").objectStore("httpInfo").get(t);o.onerror=()=>r(o.error),o.onsuccess=()=>n(o.result||null)})}return{openDb:n,saveReview:async function(t){const e=await n();return new Promise((n,r)=>{const o=e.transaction("reviews","readwrite").objectStore("reviews").put(t);o.onerror=()=>r(o.error),o.onsuccess=()=>n()})},saveReviews:async function(t){if(!Array.isArray(t)||0===t.length)return;const e=await n();return new Promise((n,r)=>{const o=e.transaction("reviews","readwrite"),s=o.objectStore("reviews");o.onerror=()=>r(o.error),o.oncomplete=()=>n();for(const e of t)e&&e.eventId&&s.put(e)})},getReviewsByUrl:async function(t){const e=await n();return new Promise((n,r)=>{const o=e.transaction("reviews","readonly").objectStore("reviews").index("url").getAll(t);o.onerror=()=>r(o.error),o.onsuccess=()=>{const t=o.result||[];t.sort((t,e)=>(t.created_at||0)-(e.created_at||0)),n(t)}})},getAllReviews:async function(){const t=await n();return new Promise((e,n)=>{const r=t.transaction("reviews","readonly").objectStore("reviews").getAll();r.onerror=()=>n(r.error),r.onsuccess=()=>e(r.result||[])})},saveHttpInfo:async function(t,e){const r=await n();return new Promise((n,o)=>{const s=r.transaction("httpInfo","readwrite").objectStore("httpInfo").put({url:t,...e});s.onerror=()=>o(s.error),s.onsuccess=()=>n()})},getHttpInfo:r,getAllHttpInfo:async function(){const t=await n();return new Promise((e,n)=>{const r=t.transaction("httpInfo","readonly").objectStore("httpInfo").getAll();r.onerror=()=>n(r.error),r.onsuccess=()=>e(r.result||[])})},clearAll:async function(){const t=await n();return new Promise((e,n)=>{const r=t.transaction(["reviews","httpInfo","mintInfo"],"readwrite");r.onerror=()=>n(r.error),r.oncomplete=()=>e(),r.objectStore("reviews").clear(),r.objectStore("httpInfo").clear(),r.objectStore("mintInfo").clear()})},isHttpInfoFresh:async function(t,e=3600){const n=await r(t);return!(!n||!n.fetchedAt)&&Math.floor(Date.now()/1e3)-n.fetchedAt<e},close:function(){t&&(t.close(),t=null,e=null)}}}}}},e={},function n(r){var o=e[r];if(void 0!==o)return o.exports;var s=e[r]={exports:{}};return t[r](s,s.exports,n),s.exports}(237).MintDiscovery;var t,e});